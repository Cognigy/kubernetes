apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
# config-maps
- manifests/config-maps/config-map.yaml
- manifests/config-maps/redis.yaml
- manifests/config-maps/redis-persistent.yaml

# services
- manifests/services/service-analytics-odata.yaml
- manifests/services/service-api.yaml
- manifests/services/service-endpoint.yaml
- manifests/services/service-ui.yaml
- manifests/services/service-webchat.yaml

# nlp deployments
# todo

# deployments
- manifests/deployments/service-ai.yaml
- manifests/deployments/service-alexa-management.yaml
- manifests/deployments/service-analytics-collector.yaml
- manifests/deployments/service-analytics-conversation-collector.yaml
- manifests/deployments/service-analytics-conversation-provider.yaml
- manifests/deployments/service-analytics-odata.yaml
- manifests/deployments/service-analytics-realtime.yaml
- manifests/deployments/service-analytics-reporter.yaml
- manifests/deployments/service-api.yaml
- manifests/deployments/service-cleanup.yaml
- manifests/deployments/service-conversation-manager.yaml
- manifests/deployments/service-custom-modules.yaml
- manifests/deployments/service-endpoint.yaml
- manifests/deployments/service-execution.yaml
- manifests/deployments/service-handover.yaml
- manifests/deployments/service-http.yaml
- manifests/deployments/service-journeys.yaml
- manifests/deployments/service-logs.yaml
- manifests/deployments/service-nlp-ner.yaml
- manifests/deployments/service-parser.yaml
- manifests/deployments/service-profiles.yaml
- manifests/deployments/service-resources.yaml
- manifests/deployments/service-security.yaml
- manifests/deployments/service-task-manager.yaml
- manifests/deployments/service-trainer.yaml
- manifests/deployments/service-ui.yaml
- manifests/deployments/service-webchat.yaml

# reverse proxy
- manifests/reverse-proxy/deployments/traefik.yaml
- manifests/reverse-proxy/ingress/service-analytics-odata.yaml
- manifests/reverse-proxy/ingress/service-api.yaml
- manifests/reverse-proxy/ingress/service-endpoint.yaml
- manifests/reverse-proxy/ingress/service-ui.yaml
- manifests/reverse-proxy/ingress/service-webchat.yaml
- manifests/reverse-proxy/services/traefik.yaml

patchesJson6902:
# configmaps
- target:
    version: v1
    kind: ConfigMap
    name: cognigy-env
  path: overlays/config-maps/config-map_patch.yaml

# reverse-proxy, ingress
- target:
    group: extensions
    version: v1beta1
    kind: Ingress
    name: service-analytics-odata
  path: overlays/reverse-proxy/ingress/service-analytics-odata_patch.yaml

- target:
    group: extensions
    version: v1beta1
    kind: Ingress
    name: service-api
  path: overlays/reverse-proxy/ingress/service-api_patch.yaml

- target:
    group: extensions
    version: v1beta1
    kind: Ingress
    name: service-endpoint
  path: overlays/reverse-proxy/ingress/service-endpoint_patch.yaml

- target:
    group: extensions
    version: v1beta1
    kind: Ingress
    name: service-ui
  path: overlays/reverse-proxy/ingress/service-ui_patch.yaml

- target:
    group: extensions
    version: v1beta1
    kind: Ingress
    name: service-webchat
  path: overlays/reverse-proxy/ingress/service-webchat_patch.yaml

# reverse-proxy, service
- target:
    version: v1
    kind: Service
    name: traefik
  path: overlays/reverse-proxy/services/traefik_patch.yaml

patchesStrategicMerge:
  - replica_count.yaml