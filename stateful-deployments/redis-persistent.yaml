apiVersion: apps/v1
kind: StatefulSet
metadata:
    name: redis-persistent
spec:
    selector:
        matchLabels:
            app: redis-persistent
    serviceName: redis-persistent
    replicas: 1
    template:
        metadata:
            labels:
                app: redis-persistent
        spec:
            containers:
            - name: redis-persistent
              image: dev-docker.cognigy.com:5000/redis-cognigy:3.2.0
              ports:
                - containerPort: 6379
              volumeMounts:
              - name: redis-data
                mountPath: /data
              - name: redis-password-config
                mountPath: /run/secrets/
              - name: redis-persistent-config
                mountPath: /run/config

            volumes:
            - name: redis-password-config
              secret:
                secretName: cognigy-redis-persistent-password
                items:
                - key: redis-persistent-password.conf
                  path: redis-password.conf

            - name: redis-persistent-config
              configMap:
                name: redis-persistent

            imagePullSecrets:
            - name: cognigy-registry-token

    volumeClaimTemplates:
    - metadata:
        name: redis-data
        labels:
            app: cognigy
      spec:
        accessModes:
          - ReadWriteOnce
        storageClassName: redis-persistent
        resources:
          requests:
            storage: 10Gi